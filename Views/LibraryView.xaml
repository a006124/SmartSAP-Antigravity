<UserControl x:Class="SmartSAP.Views.LibraryView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" 
             d:DesignHeight="700" d:DesignWidth="1000">
    
    <Grid Margin="40">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,40">
            <TextBlock Text="Library" Style="{StaticResource Header1}"/>
            <TextBlock Text="Sélectionnez un module pour commencer votre workflow SAP." Style="{StaticResource SubHeader}"/>
        </StackPanel>

        <!-- Modules Grid -->
        <ItemsControl Grid.Row="1" ItemsSource="{Binding Modules}">
            <ItemsControl.ItemsPanel>
                <ItemsPanelTemplate>
                    <WrapPanel/>
                </ItemsPanelTemplate>
            </ItemsControl.ItemsPanel>
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <Button Command="{Binding DataContext.NavigateToModuleCommand, RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                            CommandParameter="{Binding Title}"
                            Background="Transparent" BorderThickness="0" Padding="0">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border Style="{StaticResource ModuleCard}" Width="280" Height="200">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="*"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <!-- Top Info -->
                                        <DockPanel Grid.Row="0">
                                            <Border Width="40" Height="40" CornerRadius="8" Background="{StaticResource BluePastelBrush}">
                                                <!-- Icon would go here -->
                                                <TextBlock Text="" FontFamily="Segoe MDL2 Assets" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="{StaticResource AccentBlueBrush}"/>
                                            </Border>
                                            <Border HorizontalAlignment="Right" Background="{StaticResource GreenPastelBrush}" CornerRadius="4" Padding="8,2">
                                                <TextBlock Text="ACTIVE" FontSize="10" FontWeight="Bold" Foreground="{StaticResource AccentGreenBrush}"/>
                                            </Border>
                                        </DockPanel>

                                        <!-- Content -->
                                        <StackPanel Grid.Row="1" Margin="0,15">
                                            <TextBlock Text="{Binding Title}" FontWeight="Bold" FontSize="16" Foreground="{StaticResource TextPrimaryBrush}"/>
                                            <TextBlock Text="{Binding Description}" TextWrapping="Wrap" Margin="0,5,0,0" Foreground="{StaticResource TextSecondaryBrush}" FontSize="12"/>
                                        </StackPanel>

                                        <!-- Footer -->
                                        <DockPanel Grid.Row="2">
                                            <TextBlock Text="{Binding Version}" Foreground="{StaticResource TextSecondaryBrush}" FontSize="10"/>
                                            <TextBlock Text="{Binding HealthStatus}" HorizontalAlignment="Right" Foreground="{StaticResource AccentGreenBrush}" FontSize="10"/>
                                        </DockPanel>
                                    </Grid>
                                </Border>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>
    </Grid>
</UserControl>
